import{b as v,r as d,j as a}from"./vendor-BjgPdEnQ.js";import{s as m}from"./game-DMqPqpoE.js";const b=()=>{const g=v(),[e,c]=d.useState({nama:"",nomorInduk:"",role:"4",kelas:"",noTelp:"",password:"",tanggalLahir:"",alamat:"",jenisKelamin:"L"}),[p,l]=d.useState(!1),[i,n]=d.useState({text:"",type:""}),j={1:"admin",2:"guru",3:"orang tua",4:"siswa"},h=t=>t==="2"||t==="4",s=t=>{const{name:r,value:u}=t.target;c({...e,[r]:u})},k=async t=>{t.preventDefault(),l(!0),n({text:"",type:""});try{if(!e.nama||!e.nomorInduk){n({text:"Nama dan nomor induk harus diisi",type:"error"}),l(!1);return}if(h(e.role)&&!e.kelas){const o=e.role==="4"?"siswa":"guru";n({text:`Kelas harus diisi untuk ${o}`,type:"error"}),l(!1);return}if(e.role==="4"&&(!e.tanggalLahir||!e.jenisKelamin)){n({text:"Tanggal lahir dan jenis kelamin harus diisi untuk siswa",type:"error"}),l(!1);return}if(e.role==="2"&&!e.noTelp){n({text:"Nomor telepon harus diisi untuk guru",type:"error"}),l(!1);return}if(!e.password){n({text:"Password harus diisi",type:"error"}),l(!1);return}let r;const u=j[e.role]||"pengguna";if(e.role==="4"){const o={nis:e.nomorInduk,nama:e.nama,id_kelas:parseInt(e.kelas),id_role:parseInt(e.role),password:e.password,tanggal_lahir:e.tanggalLahir||null,alamat:e.alamat||null,Jenis_Kelamin:e.jenisKelamin==="P"?"perempuan":"laki"};r=(await m.from("siswa").insert(o)).error}else if(e.role==="2"){const o={nuptk:e.nomorInduk,nama:e.nama,no_telp:e.noTelp,id_role:parseInt(e.role),password:e.password,kelas:parseInt(e.kelas),alamat:e.alamat||null};r=(await m.from("guru").insert(o)).error}else if(e.role==="3"){const o={nama:e.nama,no_telp:e.noTelp,id_role:parseInt(e.role),password:e.password,alamat:e.alamat||null};r=(await m.from("wali").insert(o)).error}if(r)throw r;n({text:`Akun ${u} berhasil dibuat untuk ${e.nama}`,type:"success"}),c({nama:"",nomorInduk:"",role:"4",kelas:"",noTelp:"",password:"",tanggalLahir:"",alamat:"",jenisKelamin:"L"})}catch(r){console.error("Error creating user:",r),n({text:`Error: ${r.message||"Terjadi kesalahan saat membuat akun"}`,type:"error"})}finally{l(!1)}};return a.jsx("div",{className:"login-container admin-register",children:a.jsxs("div",{className:"login-card",children:[a.jsx("h2",{children:"Admin - Registrasi Pengguna Baru"}),i.text&&a.jsx("div",{className:`message ${i.type}`,children:i.text}),a.jsxs("form",{onSubmit:k,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"role",children:"Jenis Pengguna"}),a.jsxs("select",{id:"role",name:"role",value:e.role,onChange:s,required:!0,children:[a.jsx("option",{value:"4",children:"Siswa"}),a.jsx("option",{value:"2",children:"Guru"}),a.jsx("option",{value:"3",children:"Orang Tua"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nama",children:"Nama Lengkap"}),a.jsx("input",{type:"text",id:"nama",name:"nama",value:e.nama,onChange:s,required:!0})]}),"          ",a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nomorInduk",children:e.role==="4"?"NIS":e.role==="2"?"NUPTK":"Nomor Induk"}),a.jsx("input",{type:"text",id:"nomorInduk",name:"nomorInduk",value:e.nomorInduk,onChange:s,required:!0})]}),(e.role==="2"||e.role==="3")&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"noTelp",children:"Nomor Telepon"}),a.jsx("input",{type:"tel",id:"noTelp",name:"noTelp",value:e.noTelp,onChange:s,required:e.role==="2",placeholder:"Format: 08xxxxxxxxxx"})]}),"          ",a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",name:"password",value:e.password,onChange:s,required:!0})]}),"          ",h(e.role)&&a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"kelas",children:"Kelas"}),a.jsxs("select",{id:"kelas",name:"kelas",value:e.kelas,onChange:s,required:!0,children:[a.jsx("option",{value:"",children:"Pilih Kelas"}),a.jsx("option",{value:"1",children:"Kelas 1"}),a.jsx("option",{value:"2",children:"Kelas 2"}),a.jsx("option",{value:"3",children:"Kelas 3"}),a.jsx("option",{value:"4",children:"Kelas 4"}),a.jsx("option",{value:"5",children:"Kelas 5"}),a.jsx("option",{value:"6",children:"Kelas 6"})]})]}),e.role==="4"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"tanggalLahir",children:"Tanggal Lahir"}),a.jsx("input",{type:"date",id:"tanggalLahir",name:"tanggalLahir",value:e.tanggalLahir,onChange:s,required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"jenisKelamin",children:"Jenis Kelamin"}),a.jsxs("select",{id:"jenisKelamin",name:"jenisKelamin",value:e.jenisKelamin,onChange:s,required:!0,children:[a.jsx("option",{value:"L",children:"Laki-laki"}),a.jsx("option",{value:"P",children:"Perempuan"})]})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"alamat",children:"Alamat"}),a.jsx("textarea",{id:"alamat",name:"alamat",value:e.alamat,onChange:s,rows:"3",required:e.role==="4"})]}),a.jsx("button",{type:"submit",className:"login-button",disabled:p,children:p?"Sedang Memproses...":"Daftarkan Pengguna"})]}),a.jsx("button",{className:"back-button",onClick:()=>g("/admin/dashboard"),children:"Kembali ke Dashboard Admin"})]})})};export{b as default};
