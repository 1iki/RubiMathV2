import{r as i,b as G,j as e,m as h}from"./vendor-BjgPdEnQ.js";import{b as M,a as H,s as T,g as X}from"./gold-B12Hfpl_.js";import"./game-DMqPqpoE.js";import{j as F}from"./guru-D7H-5Pkh.js";const f={1:{levels:4,title:"Bab 1",description:"Bilangan Cacah"},2:{levels:4,title:"Bab 2",description:"Operasi Hitung"},3:{levels:2,title:"Bab 3",description:"Kelipatan dan Faktor"},4:{levels:2,title:"Bab 4",description:"Pengukuran"},5:{levels:1,title:"Bab 5",description:"Statistika"},6:{levels:1,title:"Bab 6",description:"Pengolahan Data"}},k=14,n=30,c=60,x=100;function Z(){const[d,S]=i.useState(null),[a,w]=i.useState(0),[b,C]=i.useState({}),[g,j]=i.useState(null),[v,N]=i.useState({completedLevels:0,totalScore:0,averageScore:0}),[L,W]=i.useState({}),r=G(),B=async t=>{try{let s=0,o=0,l=0;const p={};for(const[u,I]of Object.entries(f)){p[u]={completed:0,totalLevels:I.levels,scores:[]};for(let y=1;y<=I.levels;y++){const m=await F(4,parseInt(u),y);m&&(m.status_selesai&&(s++,p[u].completed++),m.skor&&(p[u].scores.push(m.skor),o+=m.skor,l++))}}const E=s/k*100,O=l>0?o/l:0;w(E),C(p),N({completedLevels:s,totalScore:o,averageScore:O})}catch(s){console.error("Error fetching game progress:",s)}};i.useEffect(()=>{if(console.log("MainSiswa4 mounted"),document.body.style.backgroundColor="#ffffff",document.body.style.color="#333333",!(localStorage.getItem("isLoggedIn")==="true")){r("/login");return}const s=localStorage.getItem("userData"),o=s?JSON.parse(s):null;if(o&&o.nama)j({name:o.nama}),o.id_siswa&&B(o.id_siswa);else{console.warn("No user data found in localStorage"),r("/login");return}const l=localStorage.getItem("selectedAvatar");if(l){const p=JSON.parse(l);j({...p,displayName:o.nama})}},[r]);const z=(t,s)=>{const o=t+1,l=s+1;return L[`bab${o}_level${l}`]||!1},P=t=>{t===0?(localStorage.setItem("currentBabIndex",0),localStorage.setItem("currentLevelIndex",0),r("/category4_bab1")):t===1?(localStorage.setItem("currentBabIndex",1),localStorage.setItem("currentLevelIndex",0),r("/category4_bab2")):t===2?(localStorage.setItem("currentBabIndex",2),localStorage.setItem("currentLevelIndex",0),r("/category4_bab3")):t===3?(localStorage.setItem("currentBabIndex",3),localStorage.setItem("currentLevelIndex",0),r("/category4_bab4")):t===4?(localStorage.setItem("currentBabIndex",4),localStorage.setItem("currentLevelIndex",0),r("/category4_bab5")):t===5?(localStorage.setItem("currentBabIndex",5),localStorage.setItem("currentLevelIndex",0),r("/category4_bab6")):S(t)},_=(t,s)=>{localStorage.setItem("currentBabIndex",t),localStorage.setItem("currentLevelIndex",s),r(`/category?chapter=${t}&level=${s}`)},A=()=>{S(null)},R=()=>{localStorage.removeItem("isLoggedIn"),r("/login")},$=()=>{r("/skor")},D=()=>e.jsxs("div",{className:"progress-container",style:{position:"relative",zIndex:1,backgroundColor:"transparent",padding:"15px"},children:[e.jsxs("div",{className:"progress-info",style:{color:"white"},children:[e.jsxs("p",{children:["Progress ",e.jsx("strong",{children:g?g.displayName:"Siswa"}),": ",Math.round(a),"%"]}),e.jsxs("p",{children:["Game Selesai: ",e.jsx("strong",{children:v.completedLevels})," dari ",k]}),v.averageScore>0&&e.jsxs("p",{children:["Rata-rata Skor: ",e.jsx("strong",{children:Math.round(v.averageScore)})]})]}),e.jsxs("div",{className:"progress-bar",style:{position:"relative",marginBottom:"20px",width:"90%",margin:"0 auto 30px auto",height:"15px",backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"10px",overflow:"hidden"},children:[e.jsx(h.div,{className:"progress",style:{width:`${a}%`,height:"100%",backgroundColor:"#ff5722",borderRadius:"10px",transition:"width 0.5s ease-out"},initial:{width:0},animate:{width:`${a}%`},transition:{duration:.8}}),e.jsx("div",{style:{position:"absolute",left:`${n}%`,top:-2,bottom:-2,width:"3px",backgroundColor:"#cd7f32",transform:"translateX(-50%)"}}),e.jsx("div",{style:{position:"absolute",left:`${c}%`,top:-2,bottom:-2,width:"3px",backgroundColor:"#c0c0c0",transform:"translateX(-50%)"}}),e.jsx("div",{style:{position:"absolute",right:"0",top:-2,bottom:-2,width:"3px",backgroundColor:"#ffd700",transform:"translateX(50%)"}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"30px",position:"relative",padding:"0",height:"70px",width:"90%",margin:"0 auto",overflow:"visible"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",position:"absolute",left:`${n}%`,transform:"translateX(-50%)"},children:[e.jsx("img",{src:H,alt:"Bronze Badge",style:{width:"60px",height:"60px",marginRight:"10px",opacity:a>=n?"1":"0.4",filter:a>=n?"none":"grayscale(80%)",transition:"all 0.3s ease"}}),e.jsxs("div",{children:[e.jsx("p",{style:{margin:0,fontWeight:"bold",fontSize:"0.9rem",textAlign:"left",opacity:a>=n?"1":"0.6"},children:"Bronze"}),e.jsxs("p",{style:{margin:"2px 0 0 0",fontSize:"0.8rem",textAlign:"left",color:a>=n?"#ff5722":"#999999"},children:[n,"%"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",position:"absolute",left:`${c}%`,transform:"translateX(-50%)"},children:[e.jsx("img",{src:T,alt:"Silver Badge",style:{width:"60px",height:"60px",marginRight:"10px",opacity:a>=c?"1":"0.4",filter:a>=c?"none":"grayscale(80%)",transition:"all 0.3s ease"}}),e.jsxs("div",{children:[e.jsx("p",{style:{margin:0,fontWeight:"bold",fontSize:"0.9rem",textAlign:"left",opacity:a>=c?"1":"0.6"},children:"Silver"}),e.jsxs("p",{style:{margin:"2px 0 0 0",fontSize:"0.8rem",textAlign:"left",color:a>=c?"#ff5722":"#999999"},children:[c,"%"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",position:"absolute",left:"100%",transform:"translateX(-50%)"},children:[e.jsx("img",{src:X,alt:"Gold Badge",style:{width:"60px",height:"60px",marginRight:"10px",opacity:a>=x?"1":"0.4",filter:a>=x?"none":"grayscale(80%)",transition:"all 0.3s ease"}}),e.jsxs("div",{children:[e.jsx("p",{style:{margin:0,fontWeight:"bold",fontSize:"0.9rem",textAlign:"left",opacity:a>=x?"1":"0.6"},children:"Gold"}),e.jsxs("p",{style:{margin:"2px 0 0 0",fontSize:"0.8rem",textAlign:"left",color:a>=x?"#ff5722":"#999999"},children:[x,"%"]})]})]})]})]});return e.jsxs("div",{className:"main-siswa-container",style:{color:"#333333",backgroundImage:`url(${M})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",position:"relative"},children:[e.jsxs("header",{className:"header-siswa",style:{position:"relative",zIndex:1},children:["        ",e.jsx(h.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},style:{color:"#ff5722",textShadow:"2px 2px 4px rgba(0,0,0,0.5)"},children:"Game Matematika Siswa"}),e.jsxs("div",{className:"profile-section",children:[e.jsx("div",{className:"profile-icon",children:g?e.jsx("img",{src:g.src,alt:g.displayName||g.name,className:"avatar-image"}):"ðŸ‘¤"}),e.jsxs("div",{className:"profile-actions",children:[e.jsx("button",{onClick:$,className:"score-button",children:"Lihat Progres"}),e.jsx("button",{onClick:R,className:"logout-button",children:"Keluar"}),"          "]})]})]}),D(),e.jsx("div",{className:"chapter-buttons",style:{position:"relative",zIndex:1},children:Object.entries(f).map(([t,s],o)=>e.jsxs(h.button,{className:"big-chapter-button",onClick:()=>P(parseInt(t)-1),initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.2*o},style:{backgroundColor:"rgba(0, 0, 0, 0.6)",color:"white",textShadow:"1px 1px 2px black",padding:"25px 15px 15px",fontSize:"1.5rem",fontWeight:"bold",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{children:s.title}),e.jsx("div",{style:{fontSize:"1rem",opacity:.8},children:s.description}),b[t]&&e.jsxs("div",{style:{fontSize:"0.9rem",marginTop:"8px",color:b[t].completed===s.levels?"#4CAF50":"#FFA726"},children:[b[t].completed,"/",s.levels," Selesai"]})]},t))}),"      ",d!==null&&d!==0&&e.jsx("div",{className:"popup-overlay",style:{zIndex:10,backgroundColor:"rgba(0, 0, 0, 0.7)"},children:e.jsxs(h.div,{className:"popup",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},style:{backgroundColor:"rgba(0, 0, 0, 0.8)",border:"2px solid #ff5722",color:"white"},children:["            ",e.jsx("h2",{children:f[d+1].title}),e.jsx("div",{className:"levels",children:f[d+1].levels.map((t,s)=>e.jsx("div",{className:"level-container",children:e.jsx("button",{className:`level-button ${z(d,s)?"level-completed":""}`,onClick:()=>_(d,s),children:t})},s))}),e.jsx("button",{className:"close-popup-button",onClick:A,children:"âœ– Kembali ke Menu"})]})})]})}export{Z as default};
